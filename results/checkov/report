{"check_type": "cloudformation", "results": {"passed_checks": [{"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/EnableKeyRotation"]}, "code_block": [[20, "  KmsKey:\n"], [21, "    Type: \"AWS::KMS::Key\"\n"], [22, "    Metadata:\n"], [23, "      cfn_guard:\n"], [24, "        rules_to_suppress:\n"], [25, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [26, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [27, "      checkov:\n"], [28, "        rules_to_suppress:\n"], [29, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [30, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [31, "    Properties:\n"], [32, "      Description: \"KMS key for encrypting data in this project\"\n"], [33, "      EnableKeyRotation: true\n"], [34, "      KeyPolicy:\n"], [35, "        Version: \"2012-10-17\"\n"], [36, "        Id: \"kms-key-1\"\n"], [37, "        Statement:\n"], [38, "          - Effect: \"Allow\"\n"], [39, "            Principal:\n"], [40, "              AWS: !Sub \"arn:aws:iam::${AWS::AccountId}:root\"\n"], [41, "            Action:\n"], [42, "              - \"kms:*\"\n"], [43, "            Resource: \"*\"\n"], [44, "          - Effect: \"Allow\"\n"], [45, "            Principal:\n"], [46, "              Service: \"dynamodb.amazonaws.com\"\n"], [47, "            Action:\n"], [48, "              - \"kms:Encrypt\"\n"], [49, "              - \"kms:Decrypt\"\n"], [50, "            Resource: \"*\"\n"], [51, "            Condition:\n"], [52, "              StringEquals:\n"], [53, "                kms:CallerAccount: !Ref AWS::AccountId\n"], [54, "                kms:ViaService: !Sub dynamodb.${AWS::Region}.amazonaws.com\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [20, 54], "resource": "AWS::KMS::Key.KmsKey", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KeyPolicy/Statement/Principal"]}, "code_block": [[20, "  KmsKey:\n"], [21, "    Type: \"AWS::KMS::Key\"\n"], [22, "    Metadata:\n"], [23, "      cfn_guard:\n"], [24, "        rules_to_suppress:\n"], [25, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [26, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [27, "      checkov:\n"], [28, "        rules_to_suppress:\n"], [29, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [30, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [31, "    Properties:\n"], [32, "      Description: \"KMS key for encrypting data in this project\"\n"], [33, "      EnableKeyRotation: true\n"], [34, "      KeyPolicy:\n"], [35, "        Version: \"2012-10-17\"\n"], [36, "        Id: \"kms-key-1\"\n"], [37, "        Statement:\n"], [38, "          - Effect: \"Allow\"\n"], [39, "            Principal:\n"], [40, "              AWS: !Sub \"arn:aws:iam::${AWS::AccountId}:root\"\n"], [41, "            Action:\n"], [42, "              - \"kms:*\"\n"], [43, "            Resource: \"*\"\n"], [44, "          - Effect: \"Allow\"\n"], [45, "            Principal:\n"], [46, "              Service: \"dynamodb.amazonaws.com\"\n"], [47, "            Action:\n"], [48, "              - \"kms:Encrypt\"\n"], [49, "              - \"kms:Decrypt\"\n"], [50, "            Resource: \"*\"\n"], [51, "            Condition:\n"], [52, "              StringEquals:\n"], [53, "                kms:CallerAccount: !Ref AWS::AccountId\n"], [54, "                kms:ViaService: !Sub dynamodb.${AWS::Region}.amazonaws.com\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [20, 54], "resource": "AWS::KMS::Key.KmsKey", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.KMSKeyWildCardPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_28", "bc_check_id": "BC_AWS_GENERAL_6", "check_name": "Ensure Dynamodb point in time recovery (backup) is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/PointInTimeRecoverySpecification/PointInTimeRecoveryEnabled"]}, "code_block": [[56, "  IssueTable:\n"], [57, "    Metadata:\n"], [58, "      cfn_guard:\n"], [59, "        rules_to_suppress:\n"], [60, "          - id: aws_dynamodb_table_deletion_protection\n"], [61, "            reason: \"Deletion protection can be turned on as per requirement of the solution consumers\" \n"], [62, "    Type: \"AWS::DynamoDB::Table\"\n"], [63, "    Properties:\n"], [64, "      DeletionProtectionEnabled: false\n"], [65, "      AttributeDefinitions:\n"], [66, "        - AttributeName: \"pk\"\n"], [67, "          AttributeType: \"S\"\n"], [68, "        - AttributeName: \"sk\"\n"], [69, "          AttributeType: \"S\"\n"], [70, "      KeySchema:\n"], [71, "        - AttributeName: \"pk\"\n"], [72, "          KeyType: \"HASH\"\n"], [73, "        - AttributeName: \"sk\"\n"], [74, "          KeyType: \"RANGE\"\n"], [75, "      BillingMode: PAY_PER_REQUEST\n"], [76, "      StreamSpecification:\n"], [77, "        StreamViewType: NEW_AND_OLD_IMAGES\n"], [78, "      SSESpecification:\n"], [79, "        SSEEnabled: true\n"], [80, "        SSEType: \"KMS\"\n"], [81, "        KMSMasterKeyId: !Ref KmsKey\n"], [82, "      PointInTimeRecoverySpecification:\n"], [83, "        PointInTimeRecoveryEnabled: true\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [56, 83], "resource": "AWS::DynamoDB::Table.IssueTable", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DynamodbRecovery", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_119", "bc_check_id": "BC_AWS_GENERAL_52", "check_name": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SSESpecification/SSEEnabled", "Properties/SSESpecification/KMSMasterKeyId"]}, "code_block": [[56, "  IssueTable:\n"], [57, "    Metadata:\n"], [58, "      cfn_guard:\n"], [59, "        rules_to_suppress:\n"], [60, "          - id: aws_dynamodb_table_deletion_protection\n"], [61, "            reason: \"Deletion protection can be turned on as per requirement of the solution consumers\" \n"], [62, "    Type: \"AWS::DynamoDB::Table\"\n"], [63, "    Properties:\n"], [64, "      DeletionProtectionEnabled: false\n"], [65, "      AttributeDefinitions:\n"], [66, "        - AttributeName: \"pk\"\n"], [67, "          AttributeType: \"S\"\n"], [68, "        - AttributeName: \"sk\"\n"], [69, "          AttributeType: \"S\"\n"], [70, "      KeySchema:\n"], [71, "        - AttributeName: \"pk\"\n"], [72, "          KeyType: \"HASH\"\n"], [73, "        - AttributeName: \"sk\"\n"], [74, "          KeyType: \"RANGE\"\n"], [75, "      BillingMode: PAY_PER_REQUEST\n"], [76, "      StreamSpecification:\n"], [77, "        StreamViewType: NEW_AND_OLD_IMAGES\n"], [78, "      SSESpecification:\n"], [79, "        SSEEnabled: true\n"], [80, "        SSEType: \"KMS\"\n"], [81, "        KMSMasterKeyId: !Ref KmsKey\n"], [82, "      PointInTimeRecoverySpecification:\n"], [83, "        PointInTimeRecoveryEnabled: true\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [56, 83], "resource": "AWS::DynamoDB::Table.IssueTable", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DynamoDBTablesEncrypted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": [[85, "  LambdaDlq: \n"], [86, "    Type: AWS::SQS::Queue\n"], [87, "    Properties:\n"], [88, "      KmsMasterKeyId: !Ref KmsKey\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [85, 88], "resource": "AWS::SQS::Queue.LambdaDlq", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": [[90, "  WorkerQueue:\n"], [91, "    Type: AWS::SQS::Queue         \n"], [92, "    Properties:\n"], [93, "      VisibilityTimeout: 900\n"], [94, "      KmsMasterKeyId: !Ref KmsKey\n"], [95, "      RedrivePolicy: \n"], [96, "        deadLetterTargetArn: !GetAtt WorkerQueueDlq.Arn\n"], [97, "        maxReceiveCount: 1\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [90, 97], "resource": "AWS::SQS::Queue.WorkerQueue", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": [[99, "  WorkerQueueDlq: \n"], [100, "    Type: AWS::SQS::Queue        \n"], [101, "    Properties:\n"], [102, "      KmsMasterKeyId: !Ref KmsKey\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [99, 102], "resource": "AWS::SQS::Queue.WorkerQueueDlq", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure no IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Environment/Variables"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_363", "bc_check_id": null, "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Runtime"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure no IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Environment/Variables"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_363", "bc_check_id": null, "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Runtime"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure no IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Environment/Variables"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_363", "bc_check_id": null, "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Runtime"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_364", "bc_check_id": null, "check_name": "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Principal", "Properties/SourceArn", "Properties/SourceAccount"]}, "code_block": [[449, "  CloudWatchLambdaPermissions:\n"], [450, "    Type: AWS::Lambda::Permission\n"], [451, "    Properties:\n"], [452, "      FunctionName: !GetAtt DetectErrorFunction.Arn\n"], [453, "      Action: lambda:InvokeFunction\n"], [454, "      Principal: logs.amazonaws.com\n"], [455, "      SourceAccount: !Ref AWS::AccountId\n"], [456, "      SourceArn:  !Sub arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:${CloudWatchLogGroupName}:*\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [449, 456], "resource": "AWS::Lambda::Permission.CloudWatchLambdaPermissions", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaServicePermission", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_7", "bc_check_id": "BC_AWS_LOGGING_8", "check_name": "Ensure rotation for customer created CMKs is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/EnableKeyRotation"]}, "code_block": [[20, "  KmsKey:\n"], [21, "    Type: \"AWS::KMS::Key\"\n"], [22, "    Metadata:\n"], [23, "      cfn_guard:\n"], [24, "        rules_to_suppress:\n"], [25, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [26, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [27, "      checkov:\n"], [28, "        rules_to_suppress:\n"], [29, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [30, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [31, "    Properties:\n"], [32, "      Description: \"KMS key for encrypting data in this project\"\n"], [33, "      EnableKeyRotation: true\n"], [34, "      KeyPolicy:\n"], [35, "        Version: \"2012-10-17\"\n"], [36, "        Id: \"kms-key-1\"\n"], [37, "        Statement:\n"], [38, "          - Effect: \"Allow\"\n"], [39, "            Principal:\n"], [40, "              AWS: !Sub \"arn:aws:iam::${AWS::AccountId}:root\"\n"], [41, "            Action:\n"], [42, "              - \"kms:*\"\n"], [43, "            Resource: \"*\"\n"], [44, "          - Effect: \"Allow\"\n"], [45, "            Principal:\n"], [46, "              Service: \"dynamodb.amazonaws.com\"\n"], [47, "            Action:\n"], [48, "              - \"kms:Encrypt\"\n"], [49, "              - \"kms:Decrypt\"\n"], [50, "            Resource: \"*\"\n"], [51, "            Condition:\n"], [52, "              StringEquals:\n"], [53, "                kms:CallerAccount: !Ref AWS::AccountId\n"], [54, "                kms:ViaService: !Sub dynamodb.${AWS::Region}.amazonaws.com\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [20, 54], "resource": "AWS::KMS::Key.KmsKey", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.KMSRotation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-8", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_33", "bc_check_id": "BC_AWS_IAM_63", "check_name": "Ensure KMS key policy does not contain wildcard (*) principal", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KeyPolicy/Statement/Principal"]}, "code_block": [[20, "  KmsKey:\n"], [21, "    Type: \"AWS::KMS::Key\"\n"], [22, "    Metadata:\n"], [23, "      cfn_guard:\n"], [24, "        rules_to_suppress:\n"], [25, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [26, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [27, "      checkov:\n"], [28, "        rules_to_suppress:\n"], [29, "          - id: aws_kms_key_policy_action_does_not_have_wildcards\n"], [30, "            reason: \"Wildcards are used in account delegation which is needed. Access for DynamDB is restricted using a condition\" \n"], [31, "    Properties:\n"], [32, "      Description: \"KMS key for encrypting data in this project\"\n"], [33, "      EnableKeyRotation: true\n"], [34, "      KeyPolicy:\n"], [35, "        Version: \"2012-10-17\"\n"], [36, "        Id: \"kms-key-1\"\n"], [37, "        Statement:\n"], [38, "          - Effect: \"Allow\"\n"], [39, "            Principal:\n"], [40, "              AWS: !Sub \"arn:aws:iam::${AWS::AccountId}:root\"\n"], [41, "            Action:\n"], [42, "              - \"kms:*\"\n"], [43, "            Resource: \"*\"\n"], [44, "          - Effect: \"Allow\"\n"], [45, "            Principal:\n"], [46, "              Service: \"dynamodb.amazonaws.com\"\n"], [47, "            Action:\n"], [48, "              - \"kms:Encrypt\"\n"], [49, "              - \"kms:Decrypt\"\n"], [50, "            Resource: \"*\"\n"], [51, "            Condition:\n"], [52, "              StringEquals:\n"], [53, "                kms:CallerAccount: !Ref AWS::AccountId\n"], [54, "                kms:ViaService: !Sub dynamodb.${AWS::Region}.amazonaws.com\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [20, 54], "resource": "AWS::KMS::Key.KmsKey", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.KMSKeyWildCardPrincipal", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-kms-key-policy-does-not-contain-wildcard-principal", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_28", "bc_check_id": "BC_AWS_GENERAL_6", "check_name": "Ensure Dynamodb point in time recovery (backup) is enabled", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/PointInTimeRecoverySpecification/PointInTimeRecoveryEnabled"]}, "code_block": [[56, "  IssueTable:\n"], [57, "    Metadata:\n"], [58, "      cfn_guard:\n"], [59, "        rules_to_suppress:\n"], [60, "          - id: aws_dynamodb_table_deletion_protection\n"], [61, "            reason: \"Deletion protection can be turned on as per requirement of the solution consumers\" \n"], [62, "    Type: \"AWS::DynamoDB::Table\"\n"], [63, "    Properties:\n"], [64, "      DeletionProtectionEnabled: false\n"], [65, "      AttributeDefinitions:\n"], [66, "        - AttributeName: \"pk\"\n"], [67, "          AttributeType: \"S\"\n"], [68, "        - AttributeName: \"sk\"\n"], [69, "          AttributeType: \"S\"\n"], [70, "      KeySchema:\n"], [71, "        - AttributeName: \"pk\"\n"], [72, "          KeyType: \"HASH\"\n"], [73, "        - AttributeName: \"sk\"\n"], [74, "          KeyType: \"RANGE\"\n"], [75, "      BillingMode: PAY_PER_REQUEST\n"], [76, "      StreamSpecification:\n"], [77, "        StreamViewType: NEW_AND_OLD_IMAGES\n"], [78, "      SSESpecification:\n"], [79, "        SSEEnabled: true\n"], [80, "        SSEType: \"KMS\"\n"], [81, "        KMSMasterKeyId: !Ref KmsKey\n"], [82, "      PointInTimeRecoverySpecification:\n"], [83, "        PointInTimeRecoveryEnabled: true\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [56, 83], "resource": "AWS::DynamoDB::Table.IssueTable", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DynamodbRecovery", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_119", "bc_check_id": "BC_AWS_GENERAL_52", "check_name": "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/SSESpecification/SSEEnabled", "Properties/SSESpecification/KMSMasterKeyId"]}, "code_block": [[56, "  IssueTable:\n"], [57, "    Metadata:\n"], [58, "      cfn_guard:\n"], [59, "        rules_to_suppress:\n"], [60, "          - id: aws_dynamodb_table_deletion_protection\n"], [61, "            reason: \"Deletion protection can be turned on as per requirement of the solution consumers\" \n"], [62, "    Type: \"AWS::DynamoDB::Table\"\n"], [63, "    Properties:\n"], [64, "      DeletionProtectionEnabled: false\n"], [65, "      AttributeDefinitions:\n"], [66, "        - AttributeName: \"pk\"\n"], [67, "          AttributeType: \"S\"\n"], [68, "        - AttributeName: \"sk\"\n"], [69, "          AttributeType: \"S\"\n"], [70, "      KeySchema:\n"], [71, "        - AttributeName: \"pk\"\n"], [72, "          KeyType: \"HASH\"\n"], [73, "        - AttributeName: \"sk\"\n"], [74, "          KeyType: \"RANGE\"\n"], [75, "      BillingMode: PAY_PER_REQUEST\n"], [76, "      StreamSpecification:\n"], [77, "        StreamViewType: NEW_AND_OLD_IMAGES\n"], [78, "      SSESpecification:\n"], [79, "        SSEEnabled: true\n"], [80, "        SSEType: \"KMS\"\n"], [81, "        KMSMasterKeyId: !Ref KmsKey\n"], [82, "      PointInTimeRecoverySpecification:\n"], [83, "        PointInTimeRecoveryEnabled: true\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [56, 83], "resource": "AWS::DynamoDB::Table.IssueTable", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DynamoDBTablesEncrypted", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/ensure-that-dynamodb-tables-are-encrypted", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": [[85, "  LambdaDlq: \n"], [86, "    Type: AWS::SQS::Queue\n"], [87, "    Properties:\n"], [88, "      KmsMasterKeyId: !Ref KmsKey\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [85, 88], "resource": "AWS::SQS::Queue.LambdaDlq", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": [[90, "  WorkerQueue:\n"], [91, "    Type: AWS::SQS::Queue         \n"], [92, "    Properties:\n"], [93, "      VisibilityTimeout: 900\n"], [94, "      KmsMasterKeyId: !Ref KmsKey\n"], [95, "      RedrivePolicy: \n"], [96, "        deadLetterTargetArn: !GetAtt WorkerQueueDlq.Arn\n"], [97, "        maxReceiveCount: 1\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [90, 97], "resource": "AWS::SQS::Queue.WorkerQueue", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_27", "bc_check_id": "BC_AWS_GENERAL_16", "check_name": "Ensure all data stored in the SQS queue is encrypted", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsMasterKeyId"]}, "code_block": [[99, "  WorkerQueueDlq: \n"], [100, "    Type: AWS::SQS::Queue        \n"], [101, "    Properties:\n"], [102, "      KmsMasterKeyId: !Ref KmsKey\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [99, 102], "resource": "AWS::SQS::Queue.WorkerQueueDlq", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.SQSQueueEncryption", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-16-encrypt-sqs-queue", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure no IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[128, "  TriageFunctionRole:\n"], [129, "    Type: AWS::IAM::Role\n"], [130, "    Metadata:\n"], [131, "      cfn_nag:\n"], [132, "        rules_to_suppress:\n"], [133, "          - id: F3\n"], [134, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [135, "    Properties:\n"], [136, "      AssumeRolePolicyDocument:\n"], [137, "        Version: \"2012-10-17\"\n"], [138, "        Statement:\n"], [139, "          - Effect: Allow\n"], [140, "            Principal:\n"], [141, "              Service:\n"], [142, "                - lambda.amazonaws.com\n"], [143, "            Action:\n"], [144, "              - sts:AssumeRole\n"], [145, "      Policies:\n"], [146, "        - PolicyName: \"KMSKeyAccess\"\n"], [147, "          PolicyDocument:\n"], [148, "            Version: \"2012-10-17\"\n"], [149, "            Statement:\n"], [150, "              - Effect: \"Allow\"\n"], [151, "                Action:\n"], [152, "                  - \"kms:Encrypt\"\n"], [153, "                  - \"kms:Decrypt\"\n"], [154, "                  - \"kms:GenerateDataKey\"\n"], [155, "                Resource: !GetAtt KmsKey.Arn\n"], [156, "        - PolicyName: \"SQSAccess\"\n"], [157, "          PolicyDocument:\n"], [158, "            Version: \"2012-10-17\"\n"], [159, "            Statement:\n"], [160, "              - Effect: Allow\n"], [161, "                Action: \n"], [162, "                  - \"sqs:SendMessage\"\n"], [163, "                  - \"sqs:GetQueueAttributes\"\n"], [164, "                Resource: \n"], [165, "                  - !GetAtt WorkerQueue.Arn\n"], [166, "                  - !GetAtt LambdaDlq.Arn\n"], [167, "        - PolicyName: \"DynamoDBAccess\"\n"], [168, "          PolicyDocument:\n"], [169, "            Version: \"2012-10-17\"\n"], [170, "            Statement:\n"], [171, "              - Effect: Allow\n"], [172, "                Action:\n"], [173, "                  - \"dynamodb:GetItem\"\n"], [174, "                  - \"dynamodb:PutItem\"\n"], [175, "                  - \"dynamodb:Query\"\n"], [176, "                Resource: \n"], [177, "                  - !GetAtt IssueTable.Arn\n"], [178, "        - PolicyName: \"DynamoDBStreamAccess\"\n"], [179, "          PolicyDocument:\n"], [180, "            Version: \"2012-10-17\"\n"], [181, "            Statement:\n"], [182, "              - Effect: Allow\n"], [183, "                Action:\n"], [184, "                  - \"dynamodb:DescribeStream\"\n"], [185, "                  - \"dynamodb:GetRecords\"\n"], [186, "                  - \"dynamodb:GetShardIterator\"\n"], [187, "                  - \"dynamodb:ListStreams\"\n"], [188, "                Resource: \n"], [189, "                  - !GetAtt IssueTable.StreamArn\n"], [190, "        - PolicyName: CloudWatchLogsAccess\n"], [191, "          PolicyDocument:\n"], [192, "            Version: '2012-10-17'\n"], [193, "            Statement:\n"], [194, "            - Effect: Allow\n"], [195, "              Action:\n"], [196, "              - logs:*\n"], [197, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [128, 197], "resource": "AWS::IAM::Role.TriageFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Environment/Variables"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_363", "bc_check_id": null, "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Runtime"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure no IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[235, "  FixCodeFunctionRole:\n"], [236, "    Type: AWS::IAM::Role\n"], [237, "    Metadata:      \n"], [238, "      cfn_nag:\n"], [239, "        rules_to_suppress:\n"], [240, "          - id: F3\n"], [241, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\" \n"], [242, "    Properties:\n"], [243, "      AssumeRolePolicyDocument:\n"], [244, "        Version: \"2012-10-17\"\n"], [245, "        Statement:\n"], [246, "          - Effect: Allow\n"], [247, "            Principal:\n"], [248, "              Service:\n"], [249, "                - lambda.amazonaws.com\n"], [250, "            Action:\n"], [251, "              - sts:AssumeRole\n"], [252, "      Policies:\n"], [253, "        - PolicyName: \"SSMParameterAccess\"\n"], [254, "          PolicyDocument:\n"], [255, "            Version: \"2012-10-17\"\n"], [256, "            Statement:\n"], [257, "              - Effect: Allow\n"], [258, "                Action:\n"], [259, "                  - ssm:GetParameter\n"], [260, "                  - ssm:GetParameters\n"], [261, "                Resource: \n"], [262, "                  - !Sub \"arn:aws:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ParameterStorePrefix}*\"\n"], [263, "        - PolicyName: \"BedRockAccess\"\n"], [264, "          PolicyDocument:\n"], [265, "            Version: \"2012-10-17\"\n"], [266, "            Statement:\n"], [267, "              - Effect: Allow\n"], [268, "                Action:\n"], [269, "                - bedrock:InvokeModel\n"], [270, "                Resource: \"arn:aws:bedrock:*::foundation-model/*\"\n"], [271, "        - PolicyName: \"KMSKeyAccess\"\n"], [272, "          PolicyDocument:\n"], [273, "            Version: \"2012-10-17\"\n"], [274, "            Statement:\n"], [275, "              - Effect: \"Allow\"\n"], [276, "                Action:\n"], [277, "                  - \"kms:Encrypt\"\n"], [278, "                  - \"kms:Decrypt\"\n"], [279, "                Resource: !GetAtt KmsKey.Arn\n"], [280, "        - PolicyName: \"SQSAccess\"\n"], [281, "          PolicyDocument:\n"], [282, "            Version: \"2012-10-17\"\n"], [283, "            Statement:\n"], [284, "              - Effect: Allow\n"], [285, "                Action: \n"], [286, "                  - \"sqs:ReceiveMessage\"\n"], [287, "                  - \"sqs:DeleteMessage\"\n"], [288, "                  - \"sqs:GetQueueAttributes\"               \n"], [289, "                Resource: \n"], [290, "                  - !GetAtt WorkerQueue.Arn\n"], [291, "        - PolicyName: \"DLQAccess\"\n"], [292, "          PolicyDocument:\n"], [293, "            Version: \"2012-10-17\"\n"], [294, "            Statement:\n"], [295, "              - Effect: Allow\n"], [296, "                Action: \n"], [297, "                  - \"sqs:SendMessage\"\n"], [298, "                  - \"sqs:GetQueueAttributes\"\n"], [299, "                Resource: \n"], [300, "                  - !GetAtt LambdaDlq.Arn\n"], [301, "        - PolicyName: CloudWatchLogsAccess\n"], [302, "          PolicyDocument:\n"], [303, "            Version: '2012-10-17'\n"], [304, "            Statement:\n"], [305, "            - Effect: Allow\n"], [306, "              Action:\n"], [307, "              - logs:*\n"], [308, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [235, 308], "resource": "AWS::IAM::Role.FixCodeFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Environment/Variables"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_363", "bc_check_id": null, "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Runtime"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_60", "bc_check_id": "BC_AWS_IAM_44", "check_name": "Ensure IAM role allows only specific services or principals to assume it", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/AssumeRolePolicyDocument/Statement"]}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowsPublicAssume", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-44", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_61", "bc_check_id": "BC_AWS_IAM_45", "check_name": "Ensure AWS IAM policy does not allow assume role permission across all services", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMRoleAllowAssumeFromAccount", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-iam-45", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_110", "bc_check_id": "BC_AWS_IAM_64", "check_name": "Ensure IAM policies does not allow privilege escalation", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPrivilegeEscalation", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-does-not-allow-privilege-escalation", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_63", "bc_check_id": "BC_AWS_IAM_48", "check_name": "Ensure no IAM policies documents allow \"*\" as a statement's actions", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMStarActionPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/iam-48", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_107", "bc_check_id": "BC_AWS_IAM_54", "check_name": "Ensure IAM policies does not allow credentials exposure", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMCredentialsExposure", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-credentials-exposure", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_111", "bc_check_id": "BC_AWS_IAM_57", "check_name": "Ensure IAM policies does not allow write access without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMWriteAccess", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-write-access-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_109", "bc_check_id": "BC_AWS_IAM_56", "check_name": "Ensure IAM policies does not allow permissions management without constraints", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMPermissionsManagement", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-permissions-management-resource-exposure-without-constraint", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_108", "bc_check_id": "BC_AWS_IAM_55", "check_name": "Ensure IAM policies does not allow data exfiltration", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMDataExfiltration", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-iam-policies-do-not-allow-data-exfiltration", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_62", "bc_check_id": "BC_AWS_IAM_47", "check_name": "Ensure no IAM policies that allow full \"*-*\" administrative privileges are not created", "check_result": {"result": "PASSED", "evaluated_keys": []}, "code_block": [[348, "  DetectErrorFunctionRole:\n"], [349, "    Type: AWS::IAM::Role\n"], [350, "    Metadata:\n"], [351, "      cfn_nag:\n"], [352, "        rules_to_suppress:\n"], [353, "          - id: F3\n"], [354, "            reason: \"Log Group name are dynamic. Hence * is used in the policy\"\n"], [355, "    Properties:\n"], [356, "      AssumeRolePolicyDocument:\n"], [357, "        Version: \"2012-10-17\"\n"], [358, "        Statement:\n"], [359, "          - Effect: Allow\n"], [360, "            Principal:\n"], [361, "              Service:\n"], [362, "                - lambda.amazonaws.com\n"], [363, "            Action:\n"], [364, "              - sts:AssumeRole\n"], [365, "      Policies:\n"], [366, "        - PolicyName: \"KMSKeyAccess\"\n"], [367, "          PolicyDocument:\n"], [368, "            Version: \"2012-10-17\"\n"], [369, "            Statement:\n"], [370, "              - Effect: \"Allow\"\n"], [371, "                Action:\n"], [372, "                  - \"kms:Encrypt\"\n"], [373, "                  - \"kms:Decrypt\"\n"], [374, "                Resource: !GetAtt KmsKey.Arn\n"], [375, "        - PolicyName: \"DDBAccess\"\n"], [376, "          PolicyDocument:\n"], [377, "            Version: \"2012-10-17\"\n"], [378, "            Statement:\n"], [379, "              - Effect: Allow\n"], [380, "                Action: \n"], [381, "                  - \"dynamodb:UpdateItem\"\n"], [382, "                Resource: !GetAtt IssueTable.Arn\n"], [383, "        - PolicyName: \"DLQAccess\"\n"], [384, "          PolicyDocument:\n"], [385, "            Version: \"2012-10-17\"\n"], [386, "            Statement:\n"], [387, "              - Effect: Allow\n"], [388, "                Action: \n"], [389, "                  - \"sqs:SendMessage\"\n"], [390, "                  - \"sqs:GetQueueAttributes\"\n"], [391, "                Resource: \n"], [392, "                  - !GetAtt LambdaDlq.Arn\n"], [393, "        - PolicyName: CloudWatchLogsAccess\n"], [394, "          PolicyDocument:\n"], [395, "            Version: '2012-10-17'\n"], [396, "            Statement:\n"], [397, "            - Effect: Allow\n"], [398, "              Action:\n"], [399, "              - logs:*\n"], [400, "              Resource: arn:aws:logs:*:*:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [348, 400], "resource": "AWS::IAM::Role.DetectErrorFunctionRole", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.IAMAdminPolicyDocument", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.bridgecrew.io/docs/iam_47", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_116", "bc_check_id": "BC_AWS_GENERAL_64", "check_name": "Ensure that AWS Lambda function is configured for a Dead Letter Queue(DLQ)", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/DeadLetterConfig/TargetArn"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaDLQConfigured", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-a-dead-letter-queue-dlq", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_173", "bc_check_id": "BC_AWS_SERVERLESS_5", "check_name": "Check encryption settings for Lambda environmental variable", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/KmsKeyArn"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentEncryptionSettings", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-serverless-policies/bc-aws-serverless-5", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_45", "bc_check_id": "BC_AWS_SECRETS_3", "check_name": "Ensure no hard-coded secrets exist in lambda environment", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Environment/Variables"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaEnvironmentCredentials", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/secrets-policies/bc-aws-secrets-3", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_363", "bc_check_id": null, "check_name": "Ensure Lambda Runtime is not deprecated", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Runtime"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.DeprecatedLambdaRuntime", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_115", "bc_check_id": "BC_AWS_GENERAL_63", "check_name": "Ensure that AWS Lambda function is configured for function-level concurrent execution limit", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/ReservedConcurrentExecutions"]}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaFunctionLevelConcurrentExecutionLimit", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-for-function-level-concurrent-execution-limit", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_364", "bc_check_id": null, "check_name": "Ensure that AWS Lambda function permissions delegated to AWS services are limited by SourceArn or SourceAccount", "check_result": {"result": "PASSED", "evaluated_keys": ["Properties/Principal", "Properties/SourceArn", "Properties/SourceAccount"]}, "code_block": [[449, "  CloudWatchLambdaPermissions:\n"], [450, "    Type: AWS::Lambda::Permission\n"], [451, "    Properties:\n"], [452, "      FunctionName: !GetAtt DetectErrorFunction.Arn\n"], [453, "      Action: lambda:InvokeFunction\n"], [454, "      Principal: logs.amazonaws.com\n"], [455, "      SourceAccount: !Ref AWS::AccountId\n"], [456, "      SourceArn:  !Sub arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:${CloudWatchLogGroupName}:*\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [449, 456], "resource": "AWS::Lambda::Permission.CloudWatchLambdaPermissions", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaServicePermission", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": null, "details": [], "check_len": null, "definition_context_file_path": null}], "failed_checks": [], "skipped_checks": [{"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "SKIPPED", "suppress_comment": "Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used"}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "SKIPPED", "suppress_comment": "Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used"}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "SKIPPED", "suppress_comment": "Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used"}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/sam/template.yaml", "file_abs_path": "/src/sam/template.yaml", "repo_file_path": "/sam/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "SKIPPED", "suppress_comment": "Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used"}, "code_block": [[199, "  TriageFunction:\n"], [200, "    Type: AWS::Lambda::Function\n"], [201, "    Metadata:\n"], [202, "      checkov:\n"], [203, "        skip:\n"], [204, "          - id: \"CKV_AWS_117\"\n"], [205, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [206, "      cfn_nag:\n"], [207, "        rules_to_suppress:\n"], [208, "          - id: W89\n"], [209, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [210, "    Properties:\n"], [211, "      Runtime: python3.9\n"], [212, "      Timeout: 900\n"], [213, "      Code: package/\n"], [214, "        # S3Bucket: !Ref S3BucketName\n"], [215, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [216, "      Handler: handlers/triage.handler\n"], [217, "      ReservedConcurrentExecutions: 10\n"], [218, "      DeadLetterConfig:\n"], [219, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [220, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [221, "      Role: !GetAtt TriageFunctionRole.Arn\n"], [222, "      Environment:\n"], [223, "        Variables:\n"], [224, "          WORKER_QUEUE_URL: !Ref WorkerQueue\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [199, 224], "resource": "AWS::Lambda::Function.TriageFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "SKIPPED", "suppress_comment": "Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used"}, "code_block": [[310, "  FixCodeFunction:\n"], [311, "    Type: AWS::Lambda::Function\n"], [312, "    Metadata:\n"], [313, "      checkov:\n"], [314, "        skip:\n"], [315, "          - id: \"CKV_AWS_117\"\n"], [316, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [317, "      cfn_nag:\n"], [318, "        rules_to_suppress:\n"], [319, "          - id: W89\n"], [320, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [321, "    Properties:\n"], [322, "      Runtime: python3.9\n"], [323, "      Timeout: 900\n"], [324, "      Code: package/\n"], [325, "        # S3Bucket: !Ref S3BucketName\n"], [326, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [327, "      Handler: handlers/fix_code.handler\n"], [328, "      ReservedConcurrentExecutions: 10\n"], [329, "      DeadLetterConfig:\n"], [330, "        TargetArn: !GetAtt LambdaDlq.Arn      \n"], [331, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [332, "      Layers:\n"], [333, "        - !Sub arn:aws:lambda:${AWS::Region}:553035198032:layer:git:14\n"], [334, "      Role: !GetAtt FixCodeFunctionRole.Arn\n"], [335, "      Environment:\n"], [336, "        Variables:\n"], [337, "          PARAMETER_STORE_PREFIX: !Ref ParameterStorePrefix\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [310, 337], "resource": "AWS::Lambda::Function.FixCodeFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null}, {"check_id": "CKV_AWS_117", "bc_check_id": "BC_AWS_GENERAL_65", "check_name": "Ensure that AWS Lambda function is configured inside a VPC", "check_result": {"result": "SKIPPED", "suppress_comment": "Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used"}, "code_block": [[402, "  DetectErrorFunction:\n"], [403, "    Type: AWS::Lambda::Function\n"], [404, "    Metadata:\n"], [405, "      checkov:\n"], [406, "        skip:\n"], [407, "          - id: \"CKV_AWS_117\"\n"], [408, "            comment: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [409, "      cfn_nag:\n"], [410, "        rules_to_suppress:\n"], [411, "          - id: W89\n"], [412, "            reason: \"Appropirate access controls are implemented via IAM roles to protect the services. No VPC only services are used\" \n"], [413, "    Properties:      \n"], [414, "      Runtime: python3.9\n"], [415, "      Timeout: 900\n"], [416, "      Code: package/\n"], [417, "        # S3Bucket: !Ref S3BucketName\n"], [418, "        # S3Key: !Sub ${S3BucketPrefix}/deployment_package.zip         \n"], [419, "      Handler: handlers/detect_error.handler\n"], [420, "      ReservedConcurrentExecutions: 10\n"], [421, "      DeadLetterConfig:\n"], [422, "        TargetArn: !GetAtt LambdaDlq.Arn\n"], [423, "      KmsKeyArn: !GetAtt KmsKey.Arn\n"], [424, "      Role: !GetAtt DetectErrorFunctionRole.Arn\n"], [425, "      Environment:\n"], [426, "        Variables:\n"], [427, "          ISSUE_TABLE: !Ref IssueTable\n"]], "file_path": "/cloudformation/template.yaml", "file_abs_path": "/src/cloudformation/template.yaml", "repo_file_path": "/cloudformation/template.yaml", "file_line_range": [402, 427], "resource": "AWS::Lambda::Function.DetectErrorFunction", "evaluations": {}, "check_class": "checkov.cloudformation.checks.resource.aws.LambdaInVPC", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-aws-lambda-function-is-configured-inside-a-vpc-1", "details": [], "check_len": null, "definition_context_file_path": null}], "parsing_errors": []}, "summary": {"passed": 100, "failed": 0, "skipped": 6, "parsing_errors": 0, "resource_count": 32, "checkov_version": "3.1.51"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}